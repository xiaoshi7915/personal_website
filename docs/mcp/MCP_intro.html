<!DOCTYPE html><html lang="zh-CN"><head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>深入解析MCP协议：架构、原理与未来趋势</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&amp;family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <!-- PDF导出库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html {
            scroll-behavior: smooth;
        }
        :root {
            --primary: #0f766e;
            --secondary: #64748b;
            --accent: #14b8a6;
            --neutral: #374151;
            --base-100: #fafafa;
            --base-200: #f4f4f5;
            --base-300: #e4e4e7;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            color: var(--neutral);
            background: var(--base-100);
            line-height: 1.7;
        }
        
        .serif {
            font-family: 'Crimson Text', serif;
        }
        
        .toc-fixed {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            background: white;
            border-right: 1px solid var(--base-300);
            z-index: 50;
            overflow-y: auto;
            padding: 2rem 1.5rem;
        }
        
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
        }
        
        .hero-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            align-items: center;
            min-height: 60vh;
        }
        
        .toc-link {
            display: block;
            padding: 0.5rem 0;
            color: var(--secondary);
            text-decoration: none;
            border-left: 2px solid transparent;
            padding-left: 1rem;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .toc-link:hover,
        .toc-link.active {
            color: var(--primary);
            border-left-color: var(--accent);
            background: rgba(20, 184, 166, 0.05);
        }
        
        .citation {
            color: var(--accent);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.85rem;
            vertical-align: super;
        }
        
        .citation:hover {
            text-decoration: underline;
        }
        
        .chart-container {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }
        
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            margin: 1.5rem 0;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, rgba(20, 184, 166, 0.1), rgba(15, 118, 110, 0.05));
            border-left: 4px solid var(--accent);
            padding: 1.5rem;
            border-radius: 0 0.5rem 0.5rem 0;
            margin: 1.5rem 0;
        }
        
        .section-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, var(--base-300), transparent);
            margin: 3rem 0;
        }
        
        @media (max-width: 1024px) {
            .toc-fixed {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .toc-fixed.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .hero-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            #toc-overlay {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .hero-grid h1 {
                font-size: 2.5rem;
            }
            .hero-grid p {
                font-size: 1rem;
            }
        }
        
        /* 阅读进度条样式 */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #14b8a6, #0f766e);
            z-index: 9999;
            transition: width 0.1s ease;
        }
        
        /* 返回顶部按钮样式 */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .back-to-top:hover {
            background: #0d9488;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(20, 184, 166, 0.5);
        }
        
        /* 搜索功能样式 */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding-top: 10vh;
        }
        
        .search-overlay.active {
            display: flex;
        }
        
        .search-box {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .search-input {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            border: 2px solid var(--base-300);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .search-results {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .search-result-item {
            padding: 0.75rem;
            border-bottom: 1px solid var(--base-300);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .search-result-item:hover {
            background: var(--base-200);
        }
        
        /* 工具栏按钮样式 */
        .toolbar {
            position: fixed;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 1000;
        }
        
        .toolbar-btn {
            width: 40px;
            height: 40px;
            background: white;
            border: 1px solid var(--base-300);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .toolbar-btn:hover {
            background: var(--base-200);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        /* 暗色模式样式 */
        body.dark-mode {
            background: #0f172a;
            color: #e2e8f0;
        }
        
        body.dark-mode .toc-fixed {
            background: #1e293b;
            border-right-color: #334155;
        }
        
        body.dark-mode .main-content {
            background: #0f172a;
        }
        
        body.dark-mode .search-box,
        body.dark-mode .code-block,
        body.dark-mode .chart-container {
            background: #1e293b;
            border-color: #334155;
            color: #e2e8f0;
        }
        
        body.dark-mode .search-input {
            background: #1e293b;
            border-color: #334155;
            color: #e2e8f0;
        }
        
        body.dark-mode .toolbar-btn {
            background: #1e293b;
            border-color: #334155;
            color: #e2e8f0;
        }
        
        body.dark-mode .highlight-box {
            background: linear-gradient(135deg, rgba(20, 184, 166, 0.2), rgba(15, 118, 110, 0.1));
        }
        
        /* 图片懒加载样式 */
        img[loading="lazy"] {
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        img[loading="lazy"].loaded {
            opacity: 1;
        }
        
        /* 打印样式优化 */
        @media print {
            .toc-fixed,
            .toolbar,
            .back-to-top,
            .reading-progress {
                display: none !important;
            }
            
            .main-content {
                margin-left: 0 !important;
            }
            
            section {
                page-break-inside: avoid;
            }
        }
    </style>
  <base target="_blank">
</head>

  <body>
    <!-- 阅读进度条 -->
    <div class="reading-progress" id="readingProgress"></div>
    
    <!-- 工具栏 -->
    <div class="toolbar">
        <!-- 搜索按钮 -->
        <button class="toolbar-btn" id="searchBtn" title="搜索 (Ctrl+K)">
            <i class="fas fa-search"></i>
        </button>
        <!-- 暗色模式切换按钮 -->
        <button class="toolbar-btn" id="themeToggle" title="切换主题">
            <i class="fas fa-moon"></i>
        </button>
        <!-- 分享按钮 -->
        <button class="toolbar-btn" id="shareBtn" title="分享">
            <i class="fas fa-share-alt"></i>
        </button>
        <!-- PDF导出按钮 -->
        <button class="toolbar-btn" id="pdfBtn" title="导出PDF" style="background: #ef4444; color: white; border-color: #ef4444;">
            <i class="fas fa-file-pdf"></i>
        </button>
    </div>
    
    <!-- 搜索覆盖层 -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-box">
            <input type="text" class="search-input" id="searchInput" placeholder="搜索内容... (按ESC关闭)">
            <div class="search-results" id="searchResults"></div>
        </div>
    </div>
    
    <!-- 返回顶部按钮 -->
    <button class="back-to-top" id="backToTop" title="返回顶部">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- Table of Contents -->
    <nav class="toc-fixed">
      <div class="mb-8">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">目录</h3>
      </div>
      <div class="space-y-1">
        <a class="toc-link" href="#overview">概述</a>
        <a class="toc-link" href="#concepts">核心概念</a>
        <a class="toc-link" href="#architecture">架构设计</a>
        <a class="toc-link" href="#primitives">核心原语</a>
        <a class="toc-link" href="#technical">技术原理</a>
        <a class="toc-link" href="#implementation">实现方式</a>
        <a class="toc-link" href="#use-cases">使用案例</a>
        <a class="toc-link" href="#advantages">优势分析</a>
        <a class="toc-link" href="#limitations">局限性</a>
        <a class="toc-link" href="#future">未来展望</a>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Hero Section -->
      <section class="bg-gradient-to-br from-slate-50 to-teal-50 py-16 px-8">
        <div class="max-w-6xl mx-auto">
          <div class="hero-grid">
            <div>
              <div class="mb-6">
                <span class="inline-block bg-teal-100 text-teal-800 px-3 py-1 rounded-full text-sm font-medium">技术深度解析</span>
              </div>
              <h1 class="text-5xl font-bold serif text-gray-900 mb-6 leading-tight">
                深入解析<em class="text-teal-600">MCP协议</em>：架构、原理与未来趋势
              </h1>
              <p class="text-xl text-gray-600 mb-8 leading-relaxed">
                探索模型上下文协议如何革命性地改变AI与外部系统的集成方式，从碎片化连接到标准化协作的转变
              </p>
              <div class="flex items-center space-x-6 text-sm text-gray-500">
                <div class="flex items-center">
                  <i class="fas fa-calendar mr-2"></i>
                  <span>2024年11月发布</span>
                </div>
                <div class="flex items-center">
                  <i class="fas fa-code-branch mr-2"></i>
                  <span>开源标准协议</span>
                </div>
                <div class="flex items-center">
                  <i class="fas fa-network-wired mr-2"></i>
                  <span>JSON-RPC 2.0</span>
                </div>
              </div>
            </div>
            <div class="relative">
              <img alt="MCP协议抽象视觉表现" class="w-full h-80 object-cover rounded-xl shadow-lg" src="https://kimi-web-img.moonshot.cn/img/i-blog.csdnimg.cn/eb475852f5e6d81246dc1ce2d91c761f0c3ef470.png" loading="lazy" referrerpolicy="no-referrer"/>
              <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-xl"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Key Highlights -->
      <section class="py-12 px-8 bg-white">
        <div class="max-w-6xl mx-auto">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="highlight-box">
              <div class="flex items-center mb-3">
                <i class="fas fa-plug text-teal-600 text-xl mr-3"></i>
                <h3 class="font-semibold text-gray-900">USB-C接口类比</h3>
              </div>
              <p class="text-gray-600">标准化连接方式，解决N×M集成难题，将复杂性从N×M降低到M+N个组件</p>
            </div>
            <div class="highlight-box">
              <div class="flex items-center mb-3">
                <i class="fas fa-puzzle-piece text-teal-600 text-xl mr-3"></i>
                <h3 class="font-semibold text-gray-900">解耦设计</h3>
              </div>
              <p class="text-gray-600">AI的&#34;意图&#34;与外部系统的&#34;实现&#34;彻底分离，提升系统模块化和可维护性</p>
            </div>
            <div class="highlight-box">
              <div class="flex items-center mb-3">
                <i class="fas fa-expand-arrows-alt text-teal-600 text-xl mr-3"></i>
                <h3 class="font-semibold text-gray-900">动态扩展</h3>
              </div>
              <p class="text-gray-600">运行时动态发现和调用能力，支持局部和远程两种传输方式</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Protocol Overview -->
      <section class="py-16 px-8" id="overview">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">协议概述与前世今生</h2>

          <div class="prose prose-lg max-w-none">
            <h3 class="text-2xl font-semibold text-gray-800 mb-4">MCP协议简介</h3>
            <p class="mb-6">
              模型上下文协议（Model Context Protocol, MCP）是由Anthropic公司于2024年11月推出的一项开创性开放标准<a class="citation" href="https://medium.com/@nimritakoul01/the-model-context-protocol-mcp-a-complete-tutorial-a3abe8a7f4ef">[114]</a>。该协议的核心目标是为AI应用程序（如Claude或ChatGPT）与外部数据源、工具及工作流之间建立一种安全、标准化的双向通信机制<a class="citation" href="https://www.cnblogs.com/jmcui/p/19105964">[19]</a>。
            </p>

            <div class="highlight-box my-8">
              <p class="font-medium text-gray-800 mb-2">
                <i class="fas fa-lightbulb text-teal-600 mr-2"></i>
                核心创新
              </p>
              <p class="text-gray-600">
                MCP被形象地比喻为AI应用的<strong>&#34;USB-C接口&#34;</strong>，通过提供统一的连接方式，极大地简化了AI与多样化外部世界的交互，解决了长期以来困扰开发者的&#34;N×M&#34;集成难题。
              </p>
            </div>

            <p class="mb-6">
              通过MCP，AI模型能够突破其训练数据集的限制，动态地访问实时信息、调用外部工具并执行复杂的工作流，从而生成更具上下文感知能力和现实相关性的响应。传统方式需要N×M个定制化的连接器，而MCP通过标准化的客户端-服务器架构，将这一复杂性降低为M+N个组件<a class="citation" href="https://gist.github.com/tkersey/dc9bfe3f2b5be52d5516763b0b352ad4">[141]</a>。
            </p>

            <h3 class="text-2xl font-semibold text-gray-800 mb-4 mt-12">MCP协议的起源与发展</h3>
            <p class="mb-6">
              MCP协议由Anthropic公司的Mahesh Murag主导开发，并于2024年11月正式发布<a class="citation" href="https://medium.com/@nimritakoul01/the-model-context-protocol-mcp-a-complete-tutorial-a3abe8a7f4ef">[114]</a>。其诞生的背景是大型语言模型（LLM）能力的飞速发展与现实世界应用需求之间的鸿沟日益扩大。
            </p>

            <div class="bg-gray-50 rounded-lg p-6 my-8">
              <h4 class="font-semibold text-gray-800 mb-3">技术灵感来源</h4>
              <p class="text-gray-600 mb-4">
                MCP的设计深受微软的<strong>语言服务器协议（Language Server Protocol, LSP）</strong>的启发<a class="citation" href="https://www.imgeek.net/article/825368821">[88]</a>
                <a class="citation" href="https://www.getknit.dev/blog/how-mcp-works-a-look-under-the-hood-client-server-discovery-tools">[143]</a>。LSP通过基于JSON-RPC 2.0的标准协议，成功地将代码编辑器与各种编程语言的语言服务解耦。
              </p>
              <div class="flex items-center text-sm text-gray-500">
                <i class="fas fa-code mr-2"></i>
                <span>LSP成功模式 → MCP应用扩展</span>
              </div>
            </div>

            <p class="mb-6">
              自发布以来，MCP迅速获得了业界的广泛关注，并进入了一个快速发展的阶段。最初，MCP主要通过Python和TypeScript SDK提供支持，开发者可以利用这些SDK快速构建MCP服务器和客户端<a class="citation" href="https://www.firemcp.com/documentation.html">[113]</a>
              <a class="citation" href="https://medium.com/@nimritakoul01/the-model-context-protocol-mcp-a-complete-tutorial-a3abe8a7f4ef">[114]</a>。随着社区的壮大，越来越多的开发者开始贡献各种预构建的MCP服务器。
            </p>

            <div class="bg-teal-50 border-l-4 border-teal-400 p-6 my-8">
              <div class="flex items-center mb-3">
                <i class="fas fa-chart-line text-teal-600 mr-3"></i>
                <h4 class="font-semibold text-teal-800">生态系统增长</h4>
              </div>
              <p class="text-teal-700">
                到2025年，已有超过5500个公开的MCP服务器被发布，显示出其强大的生命力和应用潜力<a class="citation" href="https://mcpmanager.ai/blog/mcp-use-cases/">[132]</a>。
              </p>
            </div>
          </div>
        </div>
      </section>

      <div class="section-divider"></div>

      <!-- Core Concepts -->
      <section class="py-16 px-8" id="concepts">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">核心设计理念：解耦意图与实现</h2>

          <div class="prose prose-lg max-w-none">
            <p class="mb-6">
              MCP协议最核心的设计理念之一是<strong>&#34;解耦意图与实现&#34;（Decoupling Intent from Implementation）</strong>
              <a class="citation" href="https://www.getknit.dev/blog/how-mcp-works-a-look-under-the-hood-client-server-discovery-tools">[137]</a>。这一设计原则旨在彻底改变AI代理与外部工具的传统交互模式。
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 my-12">
              <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                <h4 class="font-semibold text-red-800 mb-3">
                  <i class="fas fa-times-circle mr-2"></i>
                  传统模式问题
                </h4>
                <ul class="text-red-700 space-y-2 text-sm">
                  <li>• 高度耦合的架构</li>
                  <li>• 复杂的集成逻辑</li>
                  <li>• 工具变更需要修改AI代码</li>
                  <li>• 维护成本高</li>
                </ul>
              </div>
              <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <h4 class="font-semibold text-green-800 mb-3">
                  <i class="fas fa-check-circle mr-2"></i>
                  MCP解决方案
                </h4>
                <ul class="text-green-700 space-y-2 text-sm">
                  <li>• 标准化中间层</li>
                  <li>• AI只表达&#34;做什么&#34;</li>
                  <li>• 服务器处理&#34;如何做&#34;</li>
                  <li>• 动态发现和调用</li>
                </ul>
              </div>
            </div>

            <p class="mb-6">
              在这种新模式下，AI模型（作为MCP客户端的一部分）不再需要关心工具的具体实现细节。当模型判断需要执行某个外部操作时，它只需向MCP服务器发送一个标准化的请求，表达其&#34;意图&#34;，例如&#34;调用名为
              <code>search_knowledge_base</code> 的工具，参数为
              <code>{&#39;query&#39;: &#39;latest sales figures&#39;}</code>&#34;<a class="citation" href="https://www.getknit.dev/blog/how-mcp-works-a-look-under-the-hood-client-server-discovery-tools">[137]</a>。
            </p>

            <div class="highlight-box my-8">
              <h4 class="font-semibold text-gray-800 mb-3">解耦带来的优势</h4>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="text-center">
                  <i class="fas fa-exchange-alt text-teal-600 text-2xl mb-2"></i>
                  <h5 class="font-medium text-gray-800">可移植性</h5>
                  <p class="text-sm text-gray-600">同一AI代理可与任何符合MCP标准的服务器协同工作</p>
                </div>
                <div class="text-center">
                  <i class="fas fa-shield-alt text-teal-600 text-2xl mb-2"></i>
                  <h5 class="font-medium text-gray-800">安全性</h5>
                  <p class="text-sm text-gray-600">工具执行被隔离在MCP服务器中，可沙箱化、审计</p>
                </div>
                <div class="text-center">
                  <i class="fas fa-cogs text-teal-600 text-2xl mb-2"></i>
                  <h5 class="font-medium text-gray-800">可维护性</h5>
                  <p class="text-sm text-gray-600">后端系统演进不影响AI客户端，新工具可动态添加</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Architecture -->
      <section class="py-16 px-8 bg-gray-50" id="architecture">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">架构模式：客户端-服务器架构</h2>

          <div class="mb-12">
            <img alt="MCP协议客户端-服务器架构示意图" class="w-full h-64 object-contain rounded-lg bg-white p-4 shadow-sm" src="https://kimi-web-img.moonshot.cn/img/i-blog.csdnimg.cn/0067f5597908db7ac895120f76576fb0e07f9895.jpeg" loading="lazy" referrerpolicy="no-referrer"/>
            <p class="text-center text-sm text-gray-500 mt-2">MCP协议客户端-服务器架构模式</p>
          </div>

          <div class="prose prose-lg max-w-none">
            <p class="mb-8">
              MCP协议采用了经典的客户端-服务器（Client-Server）架构模式，该模式旨在解耦AI模型（作为客户端）与提供外部能力的服务端。这种分层设计不仅清晰地划分了各组件的职责，还为系统的可扩展性、灵活性和安全性奠定了基础<a class="citation" href="https://jimmysong.io/zh/book/ai-handbook/mcp/overview/">[155]</a>。
            </p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 my-12">
              <div class="bg-white rounded-lg p-6 shadow-sm">
                <div class="flex items-center mb-4">
                  <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-desktop text-blue-600"></i>
                  </div>
                  <h3 class="text-xl font-semibold text-gray-800">MCP Host</h3>
                </div>
                <p class="text-gray-600 mb-4">AI模型运行的宿主环境，可以是桌面应用、IDE、CLI等</p>
                <ul class="text-sm text-gray-500 space-y-1">
                  <li>• 启动和管理AI模型进程</li>
                  <li>• 建立与MCP服务器的连接</li>
                  <li>• 协调客户端和服务器交互</li>
                </ul>
              </div>

              <div class="bg-white rounded-lg p-6 shadow-sm">
                <div class="flex items-center mb-4">
                  <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-user-friends text-green-600"></i>
                  </div>
                  <h3 class="text-xl font-semibold text-gray-800">MCP Client</h3>
                </div>
                <p class="text-gray-600 mb-4">位于AI模型与MCP服务器之间的关键代理层</p>
                <ul class="text-sm text-gray-500 space-y-1">
                  <li>• 处理所有通信细节</li>
                  <li>• 消息路由和会话管理</li>
                  <li>• 安全和权限控制</li>
                </ul>
              </div>

              <div class="bg-white rounded-lg p-6 shadow-sm">
                <div class="flex items-center mb-4">
                  <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-server text-purple-600"></i>
                  </div>
                  <h3 class="text-xl font-semibold text-gray-800">MCP Server</h3>
                </div>
                <p class="text-gray-600 mb-4">提供具体功能或数据接口的组件</p>
                <ul class="text-sm text-gray-500 space-y-1">
                  <li>• 暴露工具、资源和提示</li>
                  <li>• 封装外部系统能力</li>
                  <li>• 处理客户端调用请求</li>
                </ul>
              </div>
            </div>

            <div class="bg-white rounded-lg p-8 my-12">
              <h3 class="text-xl font-semibold text-gray-800 mb-6">架构分层设计</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                  <h4 class="font-semibold text-gray-700 mb-3">
                    <i class="fas fa-database text-blue-600 mr-2"></i>
                    数据层 (Data Layer)
                  </h4>
                  <p class="text-gray-600 text-sm mb-3">MCP协议的核心，定义基于JSON-RPC 2.0的通信规范</p>
                  <ul class="text-sm text-gray-500 space-y-1">
                    <li>• 生命周期管理</li>
                    <li>• 核心原语交互语义</li>
                    <li>• 通知机制</li>
                  </ul>
                </div>
                <div>
                  <h4 class="font-semibold text-gray-700 mb-3">
                    <i class="fas fa-network-wired text-green-600 mr-2"></i>
                    传输层 (Transport Layer)
                  </h4>
                  <p class="text-gray-600 text-sm mb-3">处理客户端和服务器之间的实际数据交换</p>
                  <ul class="text-sm text-gray-500 space-y-1">
                    <li>• 标准输入输出 (stdio)</li>
                    <li>• 可流式HTTP (Streamable HTTP)</li>
                    <li>• 连接抽象和消息帧定</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Core Primitives -->
      <section class="py-16 px-8" id="primitives">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">核心原语：工具、资源与提示</h2>

          <div class="mb-12">
            <img alt="展示工具、资源和提示三种抽象概念相互连接的示意图" class="w-full h-64 object-contain rounded-lg bg-white p-4 shadow-sm" src="https://kimi-web-img.moonshot.cn/img/blog.ppio.com/c161b5bf9abf17c410df3ceb97da296fdbb14794.PNG" loading="lazy" referrerpolicy="no-referrer"/>
            <p class="text-center text-sm text-gray-500 mt-2">MCP三种核心原语的抽象表示</p>
          </div>

          <div class="prose prose-lg max-w-none">
            <p class="mb-8">
              MCP协议定义了三种核心原语（Primitives）来抽象和封装服务器向客户端提供的能力，它们分别是<strong>工具（Tools）</strong>、<strong>资源（Resources）</strong>和<strong>提示（Prompts）</strong>。这三种原语为AI模型与外部世界交互提供了统一且语义化的接口。
            </p>

            <div class="overflow-x-auto my-12">
              <table class="w-full bg-white rounded-lg shadow-sm">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">原语类型</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">核心功能</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">控制权归属</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">交互模式</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">典型应用场景</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <tr>
                    <td class="px-6 py-4 font-medium text-blue-600">工具 (Tools)</td>
                    <td class="px-6 py-4 text-gray-600">执行操作，调用外部函数</td>
                    <td class="px-6 py-4 text-gray-600"><strong>AI模型</strong>主动调用</td>
                    <td class="px-6 py-4 text-gray-600">双向（请求-响应）</td>
                    <td class="px-6 py-4 text-gray-600">查询数据库、发送邮件、调用API</td>
                  </tr>
                  <tr class="bg-gray-50">
                    <td class="px-6 py-4 font-medium text-green-600">资源 (Resources)</td>
                    <td class="px-6 py-4 text-gray-600">提供只读数据，作为上下文</td>
                    <td class="px-6 py-4 text-gray-600"><strong>Host/用户</strong>提供，AI模型被动读取</td>
                    <td class="px-6 py-4 text-gray-600">单向（读取）</td>
                    <td class="px-6 py-4 text-gray-600">读取文件内容、获取数据库快照</td>
                  </tr>
                  <tr>
                    <td class="px-6 py-4 font-medium text-purple-600">提示 (Prompts)</td>
                    <td class="px-6 py-4 text-gray-600">提供可重用的任务模板</td>
                    <td class="px-6 py-4 text-gray-600"><strong>用户</strong>主动选择或触发</td>
                    <td class="px-6 py-4 text-gray-600">指导性（模板填充）</td>
                    <td class="px-6 py-4 text-gray-600">生成代码审查报告、创建标准化文档</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 my-12">
              <div class="bg-blue-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-blue-800 mb-4">
                  <i class="fas fa-tools mr-2"></i>
                  工具 (Tools)
                </h3>
                <p class="text-blue-700 mb-4 text-sm">
                  代表服务器端暴露给客户端的<strong>可执行函数或操作</strong>。每个工具都有唯一的名称、描述、输入参数JSON Schema和返回结果JSON Schema<a class="citation" href="https://www.cnblogs.com/Serverless/p/19168987">[154]</a>。
                </p>
                <div class="bg-blue-100 rounded p-3">
                  <p class="text-xs text-blue-800 font-mono">
                    calculate_bmi(weight_kg: float, height_m: float) → float
                  </p>
                </div>
              </div>

              <div class="bg-green-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-green-800 mb-4">
                  <i class="fas fa-database mr-2"></i>
                  资源 (Resources)
                </h3>
                <p class="text-green-700 mb-4 text-sm">
                  代表服务器提供的<strong>数据源</strong>，允许AI模型以统一的方式访问和读取外部数据。资源通过URI进行标识，类似于Web资源访问<a class="citation" href="https://mcp.vyagent.com/sdk/java/mcp-server">[160]</a>。
                </p>
                <div class="bg-green-100 rounded p-3">
                  <p class="text-xs text-green-800 font-mono">
                    file:///path/to/document.txt
                  </p>
                </div>
              </div>

              <div class="bg-purple-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-purple-800 mb-4">
                  <i class="fas fa-file-alt mr-2"></i>
                  提示 (Prompts)
                </h3>
                <p class="text-purple-700 mb-4 text-sm">
                  用于管理和重用<strong>提示模板</strong>的机制。允许服务器端定义结构化的提示模板，客户端可以获取并填充这些模板<a class="citation" href="https://mcp.vyagent.com/sdk/java/mcp-server">[160]</a>。
                </p>
                <div class="bg-purple-100 rounded p-3">
                  <p class="text-xs text-purple-800 font-mono">
                    create_ad_copy(product_name, target_audience)
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="section-divider"></div>

      <!-- Technical Principles -->
      <section class="py-16 px-8 bg-gray-50" id="technical">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">技术原理与底层实现</h2>

          <!-- JSON-RPC Section -->
          <div class="mb-16">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">通信协议：JSON-RPC 2.0</h3>

            <div class="prose prose-lg max-w-none">
              <p class="mb-6">
                MCP协议选择<strong>JSON-RPC 2.0</strong>作为其底层通信协议，这是一个关键的、经过深思熟虑的技术决策<a class="citation" href="https://www.cnblogs.com/sad-bird/articles/19095463">[134]</a>
                <a class="citation" href="https://mcpcat.io/guides/understanding-json-rpc-protocol-mcp/">[135]</a>。JSON-RPC 2.0是一个轻量级、无状态的远程过程调用（RPC）协议，它使用JSON作为数据格式。
              </p>

              <div class="highlight-box my-8">
                <h4 class="font-semibold text-gray-800 mb-3">
                  <i class="fas fa-star text-teal-600 mr-2"></i>
                  选择JSON-RPC 2.0的优势
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <h5 class="font-medium text-gray-700 mb-2">轻量级与低开销</h5>
                    <p class="text-sm text-gray-600">消息格式简洁，基于纯文本JSON，解析速度快，通信延迟低</p>
                  </div>
                  <div>
                    <h5 class="font-medium text-gray-700 mb-2">人类可读与易于调试</h5>
                    <p class="text-sm text-gray-600">格式化的JSON文本，开发者可以轻松阅读和理解通信内容</p>
                  </div>
                  <div>
                    <h5 class="font-medium text-gray-700 mb-2">标准化与生态系统</h5>
                    <p class="text-sm text-gray-600">成熟开放标准，拥有大量库和工具支持，涵盖所有主流编程语言</p>
                  </div>
                  <div>
                    <h5 class="font-medium text-gray-700 mb-2">清晰的通信模型</h5>
                    <p class="text-sm text-gray-600">严格区分请求-响应和通知，适合不同场景需求</p>
                  </div>
                </div>
              </div>

              <h4 class="text-xl font-semibold text-gray-800 mb-4">JSON-RPC 2.0消息类型</h4>

              <div class="code-block my-6">
                <pre><code>// 请求 (Request)
{
  &#34;jsonrpc&#34;: &#34;2.0&#34;,
  &#34;id&#34;: 1,
  &#34;method&#34;: &#34;tools/list&#34;,
  &#34;params&#34;: {}
}

// 响应 (Response)
{
  &#34;jsonrpc&#34;: &#34;2.0&#34;,
  &#34;id&#34;: 1,
  &#34;result&#34;: {
    &#34;tools&#34;: [
      {
        &#34;name&#34;: &#34;calculate_bmi&#34;,
        &#34;description&#34;: &#34;Calculate BMI given weight in kg and height in meters&#34;,
        &#34;inputSchema&#34;: { ... }
      }
    ]
  }
}

// 通知 (Notification)
{
  &#34;jsonrpc&#34;: &#34;2.0&#34;,
  &#34;method&#34;: &#34;notifications/message&#34;,
  &#34;params&#34;: {
    &#34;level&#34;: &#34;info&#34;,
    &#34;message&#34;: &#34;Tool execution completed&#34;
  }
}</code></pre>
              </div>
            </div>
          </div>

          <!-- Transport Mechanisms -->
          <div class="mb-16">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">通信机制与传输方式</h3>

            <div class="mb-8">
              <img alt="Stdio与HTTP传输协议对比示意图" class="w-full h-64 object-contain rounded-lg bg-white p-4 shadow-sm" src="https://kimi-web-img.moonshot.cn/imagegen/20251227/0217668317746177fa2ee3d7fbb71d5b51dbedad605a21ee0b68a_0.jpeg" loading="lazy" referrerpolicy="no-referrer"/>
              <p class="text-center text-sm text-gray-500 mt-2">MCP协议两种传输机制对比</p>
            </div>

            <div class="overflow-x-auto mb-8">
              <table class="w-full bg-white rounded-lg shadow-sm">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">特性</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">Stdio传输</th>
                    <th class="px-6 py-4 text-left font-semibold text-gray-700">Streamable HTTP传输</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <tr>
                    <td class="px-6 py-4 font-medium text-gray-700">通信范围</td>
                    <td class="px-6 py-4 text-gray-600">本地进程间通信</td>
                    <td class="px-6 py-4 text-gray-600">远程网络通信</td>
                  </tr>
                  <tr class="bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-700">实现方式</td>
                    <td class="px-6 py-4 text-gray-600">标准输入输出流</td>
                    <td class="px-6 py-4 text-gray-600">HTTP协议 + SSE/流式响应</td>
                  </tr>
                  <tr>
                    <td class="px-6 py-4 font-medium text-gray-700">性能</td>
                    <td class="px-6 py-4 text-gray-600"><strong>极高</strong>，无网络开销</td>
                    <td class="px-6 py-4 text-gray-600">受网络状况影响</td>
                  </tr>
                  <tr class="bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-700">安全性</td>
                    <td class="px-6 py-4 text-gray-600"><strong>高</strong>，进程隔离</td>
                    <td class="px-6 py-4 text-gray-600">需额外配置HTTPS、认证</td>
                  </tr>
                  <tr>
                    <td class="px-6 py-4 font-medium text-gray-700">可扩展性</td>
                    <td class="px-6 py-4 text-gray-600">一对一通信，扩展性有限</td>
                    <td class="px-6 py-4 text-gray-600">支持一对多，易于水平扩展</td>
                  </tr>
                  <tr class="bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-700">部署场景</td>
                    <td class="px-6 py-4 text-gray-600">本地AI应用、开发调试</td>
                    <td class="px-6 py-4 text-gray-600">云端SaaS、企业级API</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
              <div class="bg-white rounded-lg p-6">
                <h4 class="font-semibold text-gray-800 mb-4">
                  <i class="fas fa-terminal text-blue-600 mr-2"></i>
                  Stdio传输
                </h4>
                <p class="text-gray-600 mb-4 text-sm">
                  最基础、直接的通信方式，用于同一台机器上的进程间通信<a class="citation" href="https://modelcontextprotocol.io/docs/learn/architecture">[119]</a>。
                </p>
                <div class="space-y-2 text-sm text-gray-500">
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>性能极高，无网络开销</span>
                  </div>
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>实现简单且安全</span>
                  </div>
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>操作系统级进程隔离</span>
                  </div>
                </div>
              </div>

              <div class="bg-white rounded-lg p-6">
                <h4 class="font-semibold text-gray-800 mb-4">
                  <i class="fas fa-cloud text-green-600 mr-2"></i>
                  Streamable HTTP传输
                </h4>
                <p class="text-gray-600 mb-4 text-sm">
                  为满足远程、分布式和企业级部署需求而设计的核心通信机制<a class="citation" href="https://blog.ailemon.net/2025/04/15/mcp-introduction-forecast/">[157]</a>。
                </p>
                <div class="space-y-2 text-sm text-gray-500">
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>统一端点，简化路由</span>
                  </div>
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>按需流式传输</span>
                  </div>
                  <div class="flex items-center">
                    <i class="fas fa-check text-green-500 mr-2"></i>
                    <span>会话管理与恢复</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Registration and Invocation Flow -->
          <div>
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">工具/资源/提示的注册与调用流程</h3>

            <div class="prose prose-lg max-w-none">
              <h4 class="text-xl font-semibold text-gray-800 mb-4">动态发现机制</h4>
              <p class="mb-6">
                MCP的交互始于一个动态发现的过程。当MCP客户端成功连接到MCP服务器后，首先会进行初始化握手。在握手过程中，客户端和服务器会交换各自的能力（Capabilities）信息<a class="citation" href="https://mcpcn.com/docs/sdk/java/mcp-overview/">[158]</a>。
              </p>

              <div class="bg-white rounded-lg p-6 my-8">
                <h4 class="font-semibold text-gray-800 mb-4">工具调用完整流程</h4>
                <div class="space-y-4">
                  <div class="flex items-start">
                    <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium mr-4 mt-1">1</div>
                    <div>
                      <h5 class="font-medium text-gray-800">客户端发起请求</h5>
                      <p class="text-sm text-gray-600">构建
                        <code>tools/call</code> JSON-RPC请求，包含工具名称和参数
                      </p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-medium mr-4 mt-1">2</div>
                    <div>
                      <h5 class="font-medium text-gray-800">服务器接收并执行</h5>
                      <p class="text-sm text-gray-600">查找已注册的工具实现，传递参数并执行函数</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <div class="w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-medium mr-4 mt-1">3</div>
                    <div>
                      <h5 class="font-medium text-gray-800">服务器返回结果</h5>
                      <p class="text-sm text-gray-600">封装执行结果为JSON-RPC响应，使用相同ID返回</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <div class="w-8 h-8 bg-orange-500 text-white rounded-full flex items-center justify-center text-sm font-medium mr-4 mt-1">4</div>
                    <div>
                      <h5 class="font-medium text-gray-800">客户端处理结果</h5>
                      <p class="text-sm text-gray-600">解析响应并返回给AI模型，完成调用</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Implementation -->
      <section class="py-16 px-8" id="implementation">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">实现方式与使用案例</h2>

          <!-- Server Implementation -->
          <div class="mb-16">
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">服务器端实现</h3>

            <div class="prose prose-lg max-w-none">
              <p class="mb-6">
                服务器端的实现核心是创建一个能够监听客户端请求并暴露工具、资源和提示的程序。开发者可以使用官方提供的SDK（如Python、TypeScript、Java、C#等）来快速搭建服务器。
              </p>

              <div class="bg-white rounded-lg p-6 my-8">
                <h4 class="font-semibold text-gray-800 mb-4">
                  <i class="fab fa-python text-blue-600 mr-2"></i>
                  Python SDK实现示例
                </h4>

                <div class="code-block">
                  <pre><code>from mcp.server import Server
from mcp.server.stdio import stdio_server
import mcp.types as types

# 创建服务器实例
server = Server(&#34;example-server&#34;)

# 注册一个工具
@server.tool()
async def calculate_bmi(weight_kg: float, height_m: float) -&gt; float:
    &#34;&#34;&#34;Calculate BMI given weight in kg and height in meters.&#34;&#34;&#34;
    return weight_kg / (height_m ** 2)

# 注册一个资源
@server.resource(&#34;file://greeting.txt&#34;)
async def get_greeting() -&gt; str:
    &#34;&#34;&#34;A simple greeting resource.&#34;&#34;&#34;
    return &#34;Hello from MCP!&#34;

# 启动服务器，使用stdio传输
async def main():
    async with stdio_server() as (read_stream, write_stream):
        await server.run(read_stream, write_stream)

if __name__ == &#34;__main__&#34;:
    import asyncio
    asyncio.run(main())</code></pre>
                </div>

                <div class="mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 text-sm">
                  <div class="text-center">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2">
                      <span class="text-blue-600 font-medium">1</span>
                    </div>
                    <p class="text-gray-600">安装SDK</p>
                  </div>
                  <div class="text-center">
                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2">
                      <span class="text-green-600 font-medium">2</span>
                    </div>
                    <p class="text-gray-600">创建服务器</p>
                  </div>
                  <div class="text-center">
                    <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2">
                      <span class="text-purple-600 font-medium">3</span>
                    </div>
                    <p class="text-gray-600">注册能力</p>
                  </div>
                  <div class="text-center">
                    <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-2">
                      <span class="text-orange-600 font-medium">4</span>
                    </div>
                    <p class="text-gray-600">启动服务</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Use Cases -->
          <div>
            <h3 class="text-2xl font-semibold text-gray-800 mb-6">使用案例与应用场景</h3>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6">
                <div class="w-12 h-12 bg-blue-500 text-white rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-tools"></i>
                </div>
                <h4 class="text-lg font-semibold text-gray-800 mb-3">AI与外部工具集成</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li>• 开发工具集成（VS Code、Git）</li>
                  <li>• 生产力工具（日历、邮件、Notion）</li>
                  <li>• 数据分析（SQL查询、BI工具）</li>
                </ul>
              </div>

              <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6">
                <div class="w-12 h-12 bg-green-500 text-white rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-building"></i>
                </div>
                <h4 class="text-lg font-semibold text-gray-800 mb-3">企业级AI应用</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li>• 内部知识库问答</li>
                  <li>• 自动化工作流</li>
                  <li>• 智能客户服务</li>
                </ul>
              </div>

              <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6">
                <div class="w-12 h-12 bg-purple-500 text-white rounded-lg flex items-center justify-center mb-4">
                  <i class="fas fa-globe"></i>
                </div>
                <h4 class="text-lg font-semibold text-gray-800 mb-3">跨平台AI服务</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li>• 云端AI服务</li>
                  <li>• 边缘计算</li>
                  <li>• 多智能体系统</li>
                </ul>
              </div>
            </div>

            <div class="mt-12 bg-white rounded-lg p-8">
              <h4 class="text-xl font-semibold text-gray-800 mb-6">实际应用案例：智能数据分析助手</h4>

              <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                  <h5 class="font-medium text-gray-800 mb-3">场景描述</h5>
                  <p class="text-gray-600 text-sm mb-4">
                    一个企业数据分析助手，通过MCP协议连接到公司内部的数据库、文档系统和可视化工具，为业务人员提供自然语言查询和分析能力。
                  </p>

                  <h5 class="font-medium text-gray-800 mb-3">MCP服务器集成</h5>
                  <ul class="text-sm text-gray-600 space-y-2">
                    <li>• <strong>数据库服务器</strong>：提供SQL查询工具</li>
                    <li>• <strong>文档服务器</strong>：提供知识库资源访问</li>
                    <li>• <strong>可视化服务器</strong>：提供图表生成工具</li>
                    <li>• <strong>报表服务器</strong>：提供报告生成模板</li>
                  </ul>
                </div>

                <div>
                  <h5 class="font-medium text-gray-800 mb-3">交互流程示例</h5>
                  <div class="bg-gray-50 rounded p-4 text-sm">
                    <p class="font-mono text-gray-700 mb-2">
                      用户：&#34;显示本季度销售额趋势&#34;
                    </p>
                    <div class="border-l-2 border-blue-300 pl-3 space-y-2">
                      <p class="text-gray-600">
                        1. AI调用数据库服务器的
                        <code>execute_sql</code>工具
                      </p>
                      <p class="text-gray-600">
                        2. 获取数据后，调用可视化服务器的
                        <code>create_chart</code>工具
                      </p>
                      <p class="text-gray-600">
                        3. 最后调用报表服务器的
                        <code>generate_report</code>提示模板
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="section-divider"></div>

      <!-- Advantages -->
      <section class="py-16 px-8 bg-gray-50" id="advantages">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">协议优势分析</h2>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="bg-white rounded-lg p-6">
              <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
                <i class="fas fa-plug text-blue-600"></i>
              </div>
              <h3 class="text-xl font-semibold text-gray-800 mb-4">标准化与互操作性</h3>
              <p class="text-gray-600 mb-4">
                MCP最大的优势在于其标准化。通过定义一套统一的协议，MCP解决了AI工具集成的碎片化问题。
              </p>
              <ul class="text-sm text-gray-500 space-y-2">
                <li>• 任何支持MCP的AI应用都可以与任何MCP服务器无缝协作</li>
                <li>• 无需为每个工具编写特定的适配代码</li>
                <li>• 像搭积木一样组合不同的MCP服务器</li>
                <li>• 极大地降低了开发成本</li>
              </ul>
            </div>

            <div class="bg-white rounded-lg p-6">
              <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4">
                <i class="fas fa-shield-alt text-green-600"></i>
              </div>
              <h3 class="text-xl font-semibold text-gray-800 mb-4">安全性与权限控制</h3>
              <p class="text-gray-600 mb-4">
                MCP的架构设计将安全性放在了重要位置，通过清晰的权限边界和安全隔离提供保障。
              </p>
              <ul class="text-sm text-gray-500 space-y-2">
                <li>• 工具执行逻辑封装在MCP服务器中</li>
                <li>• 可以精确控制暴露给AI模型的功能和数据</li>
                <li>• 执行严格的认证和授权策略</li>
                <li>• 通信流程可审计，便于监控和治理</li>
              </ul>
            </div>

            <div class="bg-white rounded-lg p-6">
              <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
                <i class="fas fa-expand-arrows-alt text-purple-600"></i>
              </div>
              <h3 class="text-xl font-semibold text-gray-800 mb-4">灵活性与可扩展性</h3>
              <p class="text-gray-600 mb-4">
                MCP的灵活性体现在多个方面，适应不同的部署场景和应用需求。
              </p>
              <ul class="text-sm text-gray-500 space-y-2">
                <li>• 传输层无关性（stdio/HTTP）</li>
                <li>• 核心原语抽象（工具、资源、提示）</li>
                <li>• 动态发现机制，运行时适应环境变化</li>
                <li>• 新工具可动态添加，无需修改客户端</li>
              </ul>
            </div>
          </div>

          <div class="mt-12 bg-white rounded-lg p-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-6">
              <i class="fas fa-chart-bar text-teal-600 mr-2"></i>
              优势量化分析
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <h4 class="font-medium text-gray-800 mb-4">开发效率提升</h4>
                <div class="space-y-3">
                  <div>
                    <div class="flex justify-between text-sm mb-1">
                      <span class="text-gray-600">传统集成方式</span>
                      <span class="text-gray-500">N×M复杂度</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-500 h-2 rounded-full" style="width: 100%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between text-sm mb-1">
                      <span class="text-gray-600">MCP协议方式</span>
                      <span class="text-gray-500">M+N复杂度</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-green-500 h-2 rounded-full" style="width: 30%"></div>
                    </div>
                  </div>
                </div>
                <p class="text-xs text-gray-500 mt-2">复杂度降低约70%</p>
              </div>

              <div>
                <h4 class="font-medium text-gray-800 mb-4">生态系统增长</h4>
                <div class="space-y-3">
                  <div>
                    <div class="flex justify-between text-sm mb-1">
                      <span class="text-gray-600">2024年11月</span>
                      <span class="text-gray-500">~100个服务器</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-blue-500 h-2 rounded-full" style="width: 15%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between text-sm mb-1">
                      <span class="text-gray-600">2025年</span>
                      <span class="text-gray-500">~5500个服务器</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-purple-500 h-2 rounded-full" style="width: 85%"></div>
                    </div>
                  </div>
                </div>
                <p class="text-xs text-gray-500 mt-2">生态系统增长55倍<a class="citation" href="https://mcpmanager.ai/blog/mcp-use-cases/">[132]</a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Limitations -->
      <section class="py-16 px-8" id="limitations">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">局限性分析</h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-red-50 rounded-lg p-6">
              <div class="flex items-center mb-4">
                <i class="fas fa-exclamation-triangle text-red-600 text-xl mr-3"></i>
                <h3 class="text-xl font-semibold text-red-800">技术成熟度与生态系统</h3>
              </div>
              <p class="text-red-700 mb-4">
                虽然MCP的生态系统正在快速发展，但与成熟技术标准相比，仍然处于早期阶段。
              </p>
              <ul class="text-red-600 space-y-2 text-sm">
                <li>• 可用的MCP服务器数量和种类有限</li>
                <li>• 企业级应用和垂直行业领域覆盖不足</li>
                <li>• 协议的稳定性和向后兼容性需要考验</li>
                <li>• 新旧版本平滑过渡面临挑战</li>
              </ul>
            </div>

            <div class="bg-orange-50 rounded-lg p-6">
              <div class="flex items-center mb-4">
                <i class="fas fa-clock text-orange-600 text-xl mr-3"></i>
                <h3 class="text-xl font-semibold text-orange-800">性能与延迟问题</h3>
              </div>
              <p class="text-orange-700 mb-4">
                在某些场景下，MCP可能会引入额外的性能开销。
              </p>
              <ul class="text-orange-600 space-y-2 text-sm">
                <li>• 远程HTTP传输的网络延迟</li>
                <li>• 序列化/反序列化的开销</li>
                <li>• 实时交互应用可能受影响</li>
                <li>• 本地stdio传输限制分布式能力</li>
              </ul>
            </div>

            <div class="bg-yellow-50 rounded-lg p-6">
              <div class="flex items-center mb-4">
                <i class="fas fa-graduation-cap text-yellow-600 text-xl mr-3"></i>
                <h3 class="text-xl font-semibold text-yellow-800">开发者学习曲线</h3>
              </div>
              <p class="text-yellow-700 mb-4">
                对于不熟悉相关概念的开发者，仍然存在一定的学习门槛。
              </p>
              <ul class="text-yellow-600 space-y-2 text-sm">
                <li>• RPC、JSON Schema等概念需要掌握</li>
                <li>• 调试MCP应用比传统API更具挑战性</li>
                <li>• 涉及AI决策、协议通信、服务器执行多个环节</li>
                <li>• 需要更强的综合能力来定位和解决问题</li>
              </ul>
            </div>

            <div class="bg-blue-50 rounded-lg p-6">
              <div class="flex items-center mb-4">
                <i class="fas fa-network-wired text-blue-600 text-xl mr-3"></i>
                <h3 class="text-xl font-semibold text-blue-800">部署与运维复杂性</h3>
              </div>
              <p class="text-blue-700 mb-4">
                MCP服务器的部署和运维带来了新的挑战。
              </p>
              <ul class="text-blue-600 space-y-2 text-sm">
                <li>• 服务器发现和管理机制尚不完善</li>
                <li>• 大规模部署时的监控和治理需求</li>
                <li>• 跨网络边界的通信安全</li>
                <li>• 服务器版本管理和兼容性</li>
              </ul>
            </div>
          </div>

          <div class="mt-12 bg-white rounded-lg p-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-6">
              <i class="fas fa-balance-scale text-teal-600 mr-2"></i>
              优势与局限性平衡分析
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <h4 class="font-medium text-gray-800 mb-4">当前阶段 (2025年)</h4>
                <div class="space-y-3">
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-green-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">标准化和互操作性优势显著</span>
                  </div>
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-yellow-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">生态系统快速增长但仍有限</span>
                  </div>
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-red-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">企业级功能和安全机制待完善</span>
                  </div>
                </div>
              </div>

              <div>
                <h4 class="font-medium text-gray-800 mb-4">未来发展</h4>
                <div class="space-y-3">
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-blue-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">远程服务器支持和OAuth 2.1集成</span>
                  </div>
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-purple-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">MCP注册中心促进生态繁荣</span>
                  </div>
                  <div class="flex items-center">
                    <div class="w-4 h-4 bg-teal-500 rounded-full mr-3"></div>
                    <span class="text-sm text-gray-600">多代理系统和异步操作支持</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="section-divider"></div>

      <!-- Future Outlook -->
      <section class="py-16 px-8 bg-gray-50" id="future">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold serif text-gray-900 mb-8">现状与未来展望</h2>

          <div class="mb-12">
            <img alt="MCP协议技术未来发展趋势概念图" class="w-full h-64 object-contain rounded-lg bg-white p-4 shadow-sm" src="https://kimi-web-img.moonshot.cn/img/www.cursor-ide.com/14947e0d9d5cb90253f9cf0e9976fe2bf566eae5.png" loading="lazy" referrerpolicy="no-referrer"/>
            <p class="text-center text-sm text-gray-500 mt-2">MCP协议未来发展趋势展望</p>
          </div>

          <div class="prose prose-lg max-w-none">
            <div class="bg-white rounded-lg p-8 mb-12">
              <h3 class="text-xl font-semibold text-gray-800 mb-6">
                <i class="fas fa-chart-line text-teal-600 mr-2"></i>
                当前发展现状
              </h3>
              <p class="mb-6">
                目前，MCP协议正处于一个快速发展和被广泛接纳的阶段。由Anthropic发起的这一开放标准，已经吸引了大量开发者和企业的关注，并催生了丰富的开源生态<a class="citation" href="https://blog.openreplay.com/zh/%E5%85%AC%E5%BC%80-api-llms-mcp-%E6%8C%87%E5%8D%97/">[47]</a>。
              </p>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                  <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                  </div>
                  <h4 class="font-medium text-gray-800">平台集成</h4>
                  <p class="text-sm text-gray-600">Claude Desktop、Cursor、Replit等平台已开始集成MCP</p>
                </div>
                <div class="text-center">
                  <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-cloud text-blue-600 text-2xl"></i>
                  </div>
                  <h4 class="font-medium text-gray-800">云服务商支持</h4>
                  <p class="text-sm text-gray-600">各大云服务提供商在其大模型服务平台上提供MCP支持<a class="citation" href="https://help.aliyun.com/zh/model-studio/mcp">[43]</a>
                    <a class="citation" href="https://www.volcengine.com/docs/82379/1539085">[56]</a>
                  </p>
                </div>
                <div class="text-center">
                  <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-code-branch text-purple-600 text-2xl"></i>
                  </div>
                  <h4 class="font-medium text-gray-800">开源生态</h4>
                  <p class="text-sm text-gray-600">超过5500个公开的MCP服务器，生态系统快速增长</p>
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
              <div class="bg-white rounded-lg p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">
                  <i class="fas fa-road text-blue-600 mr-2"></i>
                  2025年发展路线图
                </h3>
                <div class="space-y-4">
                  <div class="border-l-4 border-blue-400 pl-4">
                    <h4 class="font-medium text-gray-800 mb-1">远程MCP服务器支持</h4>
                    <p class="text-sm text-gray-600">完善基于HTTP的远程通信，集成OAuth 2.1等企业级身份验证机制<a class="citation" href="https://www.getknit.dev/blog/the-future-of-mcp-roadmap-enhancements-and-whats-next">[128]</a>
                    </p>
                  </div>
                  <div class="border-l-4 border-green-400 pl-4">
                    <h4 class="font-medium text-gray-800 mb-1">MCP注册中心</h4>
                    <p class="text-sm text-gray-600">类似&#34;应用商店&#34;的平台，提供服务器发现、评估和部署功能<a class="citation" href="https://www.getknit.dev/blog/the-future-of-mcp-roadmap-enhancements-and-whats-next">[128]</a>
                    </p>
                  </div>
                  <div class="border-l-4 border-purple-400 pl-4">
                    <h4 class="font-medium text-gray-800 mb-1">多代理系统支持</h4>
                    <p class="text-sm text-gray-600">支持多代理系统和层次化代理结构，异步操作和长时间运行任务<a class="citation" href="https://www.getknit.dev/blog/the-future-of-mcp-roadmap-enhancements-and-whats-next">[128]</a>
                    </p>
                  </div>
                </div>
              </div>

              <div class="bg-white rounded-lg p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">
                  <i class="fas fa-rocket text-teal-600 mr-2"></i>
                  长期愿景
                </h3>
                <div class="space-y-4">
                  <div class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-lg p-4">
                    <h4 class="font-medium text-gray-800 mb-2">5-10年展望</h4>
                    <p class="text-sm text-gray-600">
                      MCP有望成为AI代理与现实世界交互的行业标准协议，可能与区块链、边缘计算等新兴技术深度融合<a class="citation" href="https://superagi.com/future-of-model-context-protocol-emerging-trends-and-predictions-for-mcp-servers-in-the-next-5-years/">[130]</a>。
                    </p>
                  </div>
                  <div class="space-y-2">
                    <div class="flex items-center text-sm text-gray-600">
                      <i class="fas fa-check text-green-500 mr-2"></i>
                      <span>构建更智能、互联的AI生态系统</span>
                    </div>
                    <div class="flex items-center text-sm text-gray-600">
                      <i class="fas fa-check text-green-500 mr-2"></i>
                      <span>支持多智能体协作和自主工作流</span>
                    </div>
                    <div class="flex items-center text-sm text-gray-600">
                      <i class="fas fa-check text-green-500 mr-2"></i>
                      <span>成为AI基础设施的核心组成部分</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-gradient-to-br from-teal-50 to-blue-50 rounded-lg p-8">
              <h3 class="text-xl font-semibold text-gray-800 mb-6">
                <i class="fas fa-lightbulb text-yellow-600 mr-2"></i>
                核心意义与价值
              </h3>

              <div class="prose max-w-none">
                <p class="text-gray-700 mb-6">
                  MCP的发展，标志着AI技术正从孤立的模型向一个开放、互联、可协作的生态系统演进，其最终目标是让AI能够像人类一样，无缝地利用各种工具和资源，解决现实世界中的复杂问题。
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <h4 class="font-medium text-gray-800 mb-3">技术演进意义</h4>
                    <ul class="text-sm text-gray-600 space-y-2">
                      <li>• <strong>从孤立到互联</strong>：打破AI系统之间的壁垒</li>
                      <li>• <strong>从封闭到开放</strong>：标准化接口促进协作</li>
                      <li>• <strong>从静态到动态</strong>：实时访问外部信息和工具</li>
                    </ul>
                  </div>

                  <div>
                    <h4 class="font-medium text-gray-800 mb-3">应用价值</h4>
                    <ul class="text-sm text-gray-600 space-y-2">
                      <li>• <strong>简化集成</strong>：降低AI应用开发门槛</li>
                      <li>• <strong>促进创新</strong>：催生新的AI应用模式</li>
                      <li>• <strong>提升能力</strong>：扩展AI解决问题的范围</li>
                    </ul>
                  </div>
                </div>

                <div class="mt-6 p-4 bg-white rounded-lg">
                  <p class="text-sm text-gray-600 font-medium mb-2">
                    <i class="fas fa-quote-left text-gray-400 mr-2"></i>
                    核心理念
                  </p>
                  <p class="text-gray-700 italic">
                    &#34;让AI能够像人类一样使用工具、查询信息并执行任务&#34; — 这不仅是一个技术标准，更是AI发展的重要里程碑，为构建真正智能和自主的AI代理奠定了基础。
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="py-12 px-8 bg-gray-900 text-white">
        <div class="max-w-6xl mx-auto text-center">
          <div class="mb-8">
            <h3 class="text-xl font-semibold mb-4">深入解析MCP协议</h3>
            <p class="text-gray-400">从架构设计到未来趋势的全景分析</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
            <div>
              <h4 class="font-medium mb-3">核心概念</h4>
              <ul class="text-gray-400 space-y-1 text-sm">
                <li>解耦意图与实现</li>
                <li>客户端-服务器架构</li>
                <li>工具/资源/提示原语</li>
              </ul>
            </div>
            <div>
              <h4 class="font-medium mb-3">技术特点</h4>
              <ul class="text-gray-400 space-y-1 text-sm">
                <li>JSON-RPC 2.0协议</li>
                <li>Stdio/HTTP传输</li>
                <li>动态发现机制</li>
              </ul>
            </div>
            <div>
              <h4 class="font-medium mb-3">应用场景</h4>
              <ul class="text-gray-400 space-y-1 text-sm">
                <li>AI工具集成</li>
                <li>企业级应用</li>
                <li>跨平台服务</li>
              </ul>
            </div>
          </div>

          <div class="border-t border-gray-800 pt-8">
            <p class="text-gray-500 text-sm">
              2025 MCP协议技术解析 | 基于开源标准和社区生态的技术研究
            </p>
          </div>
        </div>
      </footer>
    </main>

    <script>
        // ==================== 工具函数 ====================
        
        /**
         * 防抖函数 - 限制函数执行频率，优化性能
         * @param {Function} func - 要执行的函数
         * @param {number} wait - 等待时间（毫秒）
         */
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // ==================== 目录高亮功能 ====================
        
        /**
         * 更新目录中当前章节的高亮状态
         */
        function updateActiveLink() {
            const sections = document.querySelectorAll('section[id]');
            const tocLinks = document.querySelectorAll('.toc-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (scrollY >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });
            
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }
        
        // 滚动时更新目录高亮（使用防抖优化性能）
        window.addEventListener('scroll', debounce(updateActiveLink, 100));
        updateActiveLink(); // 初始调用
        
        // ==================== 平滑滚动功能 ====================
        
        /**
         * 为所有锚点链接添加平滑滚动效果
         */
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    // 移动端点击后关闭目录
                    if (window.innerWidth <= 1024) {
                        const toc = document.querySelector('.toc-fixed');
                        toc.classList.remove('open');
                    }
                }
            });
        });
        
        // ==================== 移动端目录切换 ====================
        
        /**
         * 移动端目录显示/隐藏切换
         */
        let tocToggle = document.createElement('button');
        tocToggle.innerHTML = '<i class="fas fa-bars"></i>';
        tocToggle.className = 'fixed top-4 left-4 z-50 bg-white p-2 rounded-lg shadow-lg lg:hidden';
        tocToggle.onclick = () => {
            const toc = document.querySelector('.toc-fixed');
            toc.classList.toggle('open');
        };
        document.body.appendChild(tocToggle);
        
        // 创建移动端目录遮罩层
        let tocOverlay = document.createElement('div');
        tocOverlay.id = 'toc-overlay';
        tocOverlay.className = 'fixed inset-0 bg-black/50 z-40 hidden lg:hidden';
        tocOverlay.onclick = () => {
            const toc = document.querySelector('.toc-fixed');
            toc.classList.remove('open');
        };
        document.body.appendChild(tocOverlay);
        
        // 监听目录打开/关闭状态，控制遮罩层显示
        const tocObserver = new MutationObserver(() => {
            const toc = document.querySelector('.toc-fixed');
            if (toc.classList.contains('open')) {
                tocOverlay.classList.remove('hidden');
            } else {
                tocOverlay.classList.add('hidden');
            }
        });
        tocObserver.observe(document.querySelector('.toc-fixed'), { attributes: true });
        
        // ==================== 阅读进度条功能 ====================
        
        /**
         * 更新阅读进度条
         */
        function updateReadingProgress() {
            const progressBar = document.getElementById('readingProgress');
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight;
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const progress = (scrollTop / (documentHeight - windowHeight)) * 100;
            progressBar.style.width = Math.min(progress, 100) + '%';
        }
        
        // 滚动时更新进度条
        window.addEventListener('scroll', debounce(updateReadingProgress, 10));
        
        // ==================== 返回顶部功能 ====================
        
        /**
         * 返回顶部按钮显示/隐藏控制
         */
        function toggleBackToTop() {
            const backToTopBtn = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        }
        
        /**
         * 返回顶部按钮点击事件
         */
        document.getElementById('backToTop').addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // 滚动时控制返回顶部按钮显示
        window.addEventListener('scroll', debounce(toggleBackToTop, 100));
        
        // ==================== 搜索功能 ====================
        
        /**
         * 搜索功能实现
         */
        const searchOverlay = document.getElementById('searchOverlay');
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const searchBtn = document.getElementById('searchBtn');
        
        // 获取所有可搜索的内容
        const searchableContent = Array.from(document.querySelectorAll('h2, h3, h4, p, li')).map(el => ({
            text: el.textContent.trim(),
            element: el,
            id: el.id || el.closest('section')?.id || ''
        })).filter(item => item.text.length > 10); // 过滤太短的内容
        
        /**
         * 执行搜索
         */
        function performSearch(query) {
            if (!query.trim()) {
                searchResults.innerHTML = '';
                return;
            }
            
            const lowerQuery = query.toLowerCase();
            const results = searchableContent
                .filter(item => item.text.toLowerCase().includes(lowerQuery))
                .slice(0, 10); // 限制结果数量
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">未找到相关内容</div>';
                return;
            }
            
            searchResults.innerHTML = results.map(item => {
                const section = item.element.closest('section');
                const sectionTitle = section?.querySelector('h2')?.textContent || '未知章节';
                const preview = item.text.substring(0, 100) + '...';
                return `
                    <div class="search-result-item" onclick="scrollToElement('${item.id || section?.id}')">
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">${sectionTitle}</div>
                        <div style="font-size: 0.9rem; color: #64748b;">${preview}</div>
                    </div>
                `;
            }).join('');
        }
        
        /**
         * 滚动到指定元素
         */
        window.scrollToElement = function(id) {
            const element = document.getElementById(id) || document.querySelector(`[id="${id}"]`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                searchOverlay.classList.remove('active');
                searchInput.value = '';
                searchResults.innerHTML = '';
            }
        };
        
        // 搜索按钮点击事件
        searchBtn.addEventListener('click', () => {
            searchOverlay.classList.add('active');
            searchInput.focus();
        });
        
        // 搜索输入事件（实时搜索）
        searchInput.addEventListener('input', (e) => {
            performSearch(e.target.value);
        });
        
        // ESC键关闭搜索
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                searchOverlay.classList.remove('active');
                searchInput.value = '';
                searchResults.innerHTML = '';
            }
        });
        
        // 点击覆盖层关闭搜索
        searchOverlay.addEventListener('click', (e) => {
            if (e.target === searchOverlay) {
                searchOverlay.classList.remove('active');
                searchInput.value = '';
                searchResults.innerHTML = '';
            }
        });
        
        // Ctrl/Cmd + K 快捷键打开搜索
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                searchOverlay.classList.add('active');
                searchInput.focus();
            }
        });
        
        // ==================== 暗色模式功能 ====================
        
        /**
         * 暗色模式切换
         */
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        
        // 检测系统主题偏好
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const savedTheme = localStorage.getItem('mcp-theme');
        
        // 应用主题
        function applyTheme(theme) {
            if (theme === 'dark' || (!savedTheme && prefersDark)) {
                body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                body.classList.remove('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }
        
        // 初始化主题
        applyTheme(savedTheme);
        
        // 主题切换按钮点击事件
        themeToggle.addEventListener('click', () => {
            const isDark = body.classList.contains('dark-mode');
            const newTheme = isDark ? 'light' : 'dark';
            localStorage.setItem('mcp-theme', newTheme);
            applyTheme(newTheme);
        });
        
        // 监听系统主题变化
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('mcp-theme')) {
                applyTheme(e.matches ? 'dark' : 'light');
            }
        });
        
        // ==================== 分享功能 ====================
        
        /**
         * 分享功能实现
         */
        const shareBtn = document.getElementById('shareBtn');
        
        shareBtn.addEventListener('click', async () => {
            const url = window.location.href;
            const title = document.title;
            const text = '深入解析MCP协议：架构、原理与未来趋势';
            
            // 检查是否支持Web Share API
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: title,
                        text: text,
                        url: url
                    });
                } catch (err) {
                    // 用户取消分享
                    console.log('分享已取消');
                }
            } else {
                // 降级方案：复制链接到剪贴板
                try {
                    await navigator.clipboard.writeText(url);
                    alert('链接已复制到剪贴板！');
                } catch (err) {
                    // 备用方案：显示提示
                    prompt('请复制以下链接：', url);
                }
            }
        });
        
        // ==================== PDF导出功能 ====================
        
        /**
         * PDF导出功能
         */
        const pdfBtn = document.getElementById('pdfBtn');
        
        pdfBtn.addEventListener('click', () => {
            const element = document.querySelector('.main-content');
            const opt = {
                margin: 1,
                filename: 'MCP协议深度解析.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            
            // 显示加载提示
            pdfBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            pdfBtn.disabled = true;
            
            html2pdf().set(opt).from(element).save().then(() => {
                pdfBtn.innerHTML = '<i class="fas fa-file-pdf"></i>';
                pdfBtn.disabled = false;
            }).catch(() => {
                alert('PDF导出失败，请稍后重试');
                pdfBtn.innerHTML = '<i class="fas fa-file-pdf"></i>';
                pdfBtn.disabled = false;
            });
        });
        
        // ==================== 图片懒加载 ====================
        
        /**
         * 图片懒加载实现
         */
        if ('loading' in HTMLImageElement.prototype) {
            // 浏览器支持原生懒加载
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.loading = 'lazy';
                img.addEventListener('load', () => {
                    img.classList.add('loaded');
                });
            });
        } else {
            // 降级方案：使用Intersection Observer
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src || img.src;
                        img.classList.add('loaded');
                        observer.unobserve(img);
                    }
                });
            });
            
            document.querySelectorAll('img').forEach(img => {
                imageObserver.observe(img);
            });
        }
        
        // ==================== 初始化完成 ====================
        
        console.log('MCP协议页面初始化完成！');
    </script>

  

</body></html>